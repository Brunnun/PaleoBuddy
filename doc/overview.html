<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Bruno do Rosario Petrucci" />


<title>Paleobuddy overview</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Paleobuddy overview</h1>
<h4 class="author">Bruno do Rosario Petrucci</h4>



<p><code>paleobuddy</code> is an R package for species birth-death simulation, complete with the possibility of generating phylogenetic trees and fossil records from the results. The package offers unprecedented flexibility in the choice of speciation, extinction and sampling rates, as we will showcase in this vignette.</p>
<p>The biggest reason to write and publish a simulator is to effectively test rate estimation methods with scenarios whose true dynamics are known. This leads to an intuitive overview of the package: in this vignette, we will first generate a couple of useful scenarios to show use cases of the package. Then, we will discuss the choice of rates further, detailing the customization capabilities of both the birth-death and sampling functions. Finally, we will conclude going over the shortcomings of the package, including the features we plan to implement in the future. As new versions are released, this document will be updated to reflect the newest features.</p>
<p>First we do some setup.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># importing the package functions</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(paleobuddy)</span></code></pre></div>
<div id="constant-rate-birth-death-a-use-case-with-phytools" class="section level2">
<h2>Constant rate birth-death: a use case with phytools</h2>
<p>Let us first try the simplest possible birth-death scenario - constant speciation and extinction rates. We will then use <code>phytools</code> to attempt an estimate of rates.</p>
<p>First we use the function <code>bd.sim</code>, the main birth-death simulator in the package, to generate a group.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># we set a seed so the results are reproducible</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># set the necessary parameters</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># initial number of species</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>n0 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># speciation rate - approx. 1 speciation event every 4my</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co"># we are trying to create a big phylogeny so phytools can function better</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>pp &lt;-<span class="st"> </span><span class="fl">0.25</span></span>
<span id="cb2-11"><a href="#cb2-11"></a></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co"># extinction rate - approx. 1 extinction event every 10my</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>qq &lt;-<span class="st"> </span><span class="fl">0.15</span></span>
<span id="cb2-14"><a href="#cb2-14"></a></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co"># maximum simulation time - species that die after this are considered extant</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>tMax &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co"># run the simulation</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>sim &lt;-<span class="st"> </span><span class="kw">bd.sim</span>(n0, pp, qq, tMax)</span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co"># take a look at the way the result is organized</span></span>
<span id="cb2-22"><a href="#cb2-22"></a>sim</span></code></pre></div>
<pre><code>## $TE
##  [1] 42.122381 43.381387 45.416139 40.757066 14.600095 37.181773 34.217253
##  [8] 26.925344 16.633867 18.500233 12.494394  9.759440 26.848062  9.965207
## [15]  5.986076 14.534407 15.228576 13.792877 14.370109 -0.010000 11.958451
## [22] -0.010000  8.754074 13.392018 13.692584 10.995334 -0.010000 -0.010000
## [29]  9.850568  4.524767  8.445367  8.591354 10.093147  9.188706 -0.010000
## [36] -0.010000  9.869518  1.639835  2.295223  4.597503  9.993840  5.974493
## [43]  3.454909  4.973622  3.806144 -0.010000 -0.010000  4.241444 -0.010000
## [50] -0.010000 -0.010000
## 
## $TS
##  [1] 50.01000000 46.97927267 46.39644576 45.83726471 44.09299021 39.14257601
##  [7] 34.92440334 30.78342755 23.27928686 20.66030032 19.31256641 16.95864752
## [13] 30.54567091 18.58603844 20.51122621 18.49852501 17.29156127 14.39070406
## [19] 16.01853772 11.90555011 17.38090646 13.40268330 11.34598612 18.82225643
## [25] 16.26720759 16.45209495  5.61760272  3.89307419 12.83358079  6.26362168
## [31] 10.20362218  9.99540039 12.41906912 12.18202430  2.40091907 11.88878350
## [37] 10.11719988 11.10349626  8.84068557  5.78796553 10.60123278  7.72676239
## [43]  5.98328018  5.70563080  4.85086296  3.65422728  2.71160477  5.70696388
## [49]  3.25884481  0.11836136  0.03879961
## 
## $PAR
##  [1] NA  1  1  1  1  5  5  5  5  5  5  5  8  9 10 11 11 11 12 12 14 14 14 15 16
## [26] 17 20 20 21 22 23 23 26 26 27 33 34 36 36 36 38 38 38 38 38 38 38 40 46 46
## [51] 49
## 
## $EXTANT
##  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE
## [25] FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE
## [37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE
## [49]  TRUE  TRUE  TRUE</code></pre>
<p>The output of <code>bd.sim</code> is a list of named vectors that is organized as follows</p>
<ul>
<li><code>TE</code> a list of extinction times. For an extant species, the extinction time is <code>-0.01</code>.</li>
<li><code>TS</code> a list of speciation times. For species alive at the beginning of the simulation, the speciation time is <code>tMax + 0.01</code>.</li>
<li><code>PAR</code> a list of parents. The naming of species follows the order of <code>TE</code> and <code>TS</code>, i.e. if <code>PAR[i] == 1</code>, the species whose speciation time is <code>TS[1]</code> generated species <code>i</code>.</li>
<li><code>EXTANT</code> a list of booleans indicating whether a species is alive at the end of the simulation or not. Note this could be extrapolated from the information in <code>TE</code>, but we present it for practicality’s sake.</li>
</ul>
<p>Using this object, or one generated by <code>bd.sim.constant</code> or <code>bd.sim.general</code>, the helper functions <code>bd.sim</code> calls, we can generate a phylogenetic tree using <code>make.phylo</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># there are currently not many customization options for phylogenies</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>phy &lt;-<span class="st"> </span><span class="kw">make.phylo</span>(sim)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># plot it with APE - hide tip labels since there are a lot so it looks cluttered</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>ape<span class="op">::</span><span class="kw">plot.phylo</span>(phy, <span class="dt">show.tip.label =</span> <span class="ot">FALSE</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a>ape<span class="op">::</span><span class="kw">axisPhylo</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># plot the molecular phylogeny</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>ape<span class="op">::</span><span class="kw">plot.phylo</span>(ape<span class="op">::</span><span class="kw">drop.fossil</span>(phy), <span class="dt">show.tip.label =</span> <span class="ot">FALSE</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>ape<span class="op">::</span><span class="kw">axisPhylo</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAARVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmtv+QOgCQ2/+2ZgC2///bkDrb////tmb/25D//7b//9v////+cdidAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEf0lEQVR4nO3a63aaQBRAYZpek6aGmsv7P2pRMJclc3YFZgbJ3j+yslrmMH4qwabNi4U1tTew9gSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIK2CtSku3BQnv1Vb7HHJVCpQStLIEigkWZcioOhSw1aQU3i+8WGXnsCQQJBAkECQR+A/KhxXpbHIlCNoZUSCNoEUHDxnF+WDecYWul8AtWYLVCNoZXOJ9Ck2Vd2J10BKMfQfAlU8XwCTZot0NvsHPfXWwLKckaB8i5f/fkEyn3GTwDknXTWBILyfAIu/K9+OSv9TwQCwVCBYKhAMFQgGCoQDBUIhgoEQyeeb9IvWhe5E7sWoGnLFkigGmcWaPpQgWCoQDBUIBgqEAwVCIYKBEOLAV3tnXSRzwfxHqrMyTxUoMUnClRoDwIVmpN5qECLTxSo0B4EKjQn89DlgNZ+J11sYhIo+5mrDBWIJi726W2jQJcnENSkXnaXz8myueo1iW0INCQQJBAkECQQlATa5keNy0sBTZizfALVGHphAkECQZN+2zg2Z4khRYZenkCQQJBAkEDQ+Da8k35NIEggSCBIIGiR/823ZaDxBIIEggSCBIIEWjaBIIEggSCBIIEggSCBIIGgPECrbgVAW0ogSCBIIGhhoNoX4P+pKtC8c/FmSoyYdfisBJp7LoHmHiDQGkbMOnxWAs09l0BzDxBoDSNmHf75EggSCBIIEggSCBIIEggSCBIIEggSCBIIKgH0fN80ze3hu33TfPkzeszjz4fu69Pd4fcy34IjghHh6qFgdaICQM/33Z7aw8b33Tf70Q0+3d0cHv7jj+TuhyPSI8LVQ9HqRAWAHr//7r62Nw/P94eX0W7kKe6e2P7hH7+ONRyRHhGuHgpXJyp2DeqeuFeps79rbvsH16b2fjoiOeIlWn0qXJ2oGNDu5qF/C4w/z/2f7n6drlaJI6IR4epj4epEpYC6l8Dw7h+/Bhx3/XT39W/3OMcf4/GIaES4uh8RrE5VCGh/ukaHQGffnh3BDzF6fawXaH985fNb7Fh/pRg/gt8kidX93631Ldb2V4boGvkeaPynNV+ko9UvtIFUJYDapn9So5+y7x5+9BaLRoSrcQOpitwHna6bwX3a8FPssPfoIh3e6kWrcQOpCgC1/X/sOuyrTd7pD0/8rjswcQ0ZjkiPCFe/7WV9HzWuO4EggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggaB/4A9m4WFXRQ8AAAAASUVORK5CYII=" /><!-- --></p>
<p>From here, we could use this phylogeny to run <code>phytools</code> and get an estimate of the speciation and extinction rate.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># find the fit</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>fit &lt;-<span class="st"> </span>phytools<span class="op">::</span><span class="kw">fit.bd</span>(ape<span class="op">::</span><span class="kw">drop.fossil</span>(phy))</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># get the birth and death rate</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>b &lt;-<span class="st"> </span>fit<span class="op">$</span>b</span>
<span id="cb6-6"><a href="#cb6-6"></a>d &lt;-<span class="st"> </span>fit<span class="op">$</span>d</span></code></pre></div>
<p>We set this to not run so that we do not need to add phytools as an Import in the package, but the results were approximately <code>b = 0.21</code> and <code>d = 0.22</code>. As we can see, <code>phytools</code> overestimated extinction and underestimated speciation, something common since there are two independent processes going on, births and deaths. A phylogeny with more species could lead to more accurate results, and of course if we were conducting a thorough test of <code>phytools</code> we would generate hundreds or thousands of phylogenies.</p>
<p>For illustration, we create a simulation with more than 1000 tips, with 547 extant tips.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># set a seed</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># create simulation</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co"># note nFinal and extOnly, defining we want 200 ormore extant species at the end</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>sim &lt;-<span class="st"> </span><span class="kw">bd.sim</span>(n0, pp, qq, tMax, <span class="dt">nFinal =</span> <span class="kw">c</span>(<span class="dv">200</span>, <span class="ot">Inf</span>), <span class="dt">extOnly =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co"># check the number of extant species</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="kw">sum</span>(sim<span class="op">$</span>EXTANT)</span></code></pre></div>
<pre><code>## [1] 547</code></pre>
<p>We can then run this through <code>phytools</code> as before</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># find the fit</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>fit &lt;-<span class="st"> </span>phytools<span class="op">::</span><span class="kw">fit.bd</span>(ape<span class="op">::</span><span class="kw">drop.fossil</span>(<span class="kw">make.phylo</span>(sim)))</span></code></pre></div>
<p>This yields a warning, because of the gigantic phylogeny, but also yields <code>b = 0.25</code> and <code>d = 0.12</code>. Pretty great fits, especially when considering how challenging it is to estimate extinction rates with a molecular phylogeny, and the fact we conditioned the results when we asked <code>bd.sim</code> to only give us a simulation with 200 or more extant species.</p>
</div>
<div id="linear-speciation-and-extinction-a-use-case-with-pyrate-and-footes-per-capita" class="section level2">
<h2>Linear speciation and extinction: a use case with PyRate and Foote’s Per Capita</h2>
<p>One of the pluses of <code>paleobuddy</code> is that we can generate both fossil records and phylogenies in independent processes, both coming from the same underlying birth-death simulations. We will here use the fossil record generating functions of <code>paleobuddy</code> to generate a fossil record and prepare the output for use with PyRate (Silvestro et al 2014) and Foote’s Per Capita method (Foote 2000)</p>
<p>As before, start with a simulation</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># we set a seed so the results are reproducible</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co"># set the necessary parameters</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co"># initial number of species</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>n0 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co"># speciation rate - it can be any function of time!</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>pp &lt;-<span class="st"> </span><span class="cf">function</span>(t) {</span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="fl">0.1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.001</span><span class="op">*</span>t</span>
<span id="cb10-11"><a href="#cb10-11"></a>}</span>
<span id="cb10-12"><a href="#cb10-12"></a></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co"># extinction rate - also can be any function of time</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>qq &lt;-<span class="st"> </span><span class="cf">function</span>(t) {</span>
<span id="cb10-15"><a href="#cb10-15"></a>  <span class="fl">0.03</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.01</span><span class="op">*</span>t)</span>
<span id="cb10-16"><a href="#cb10-16"></a>}</span>
<span id="cb10-17"><a href="#cb10-17"></a></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co"># maximum simulation time - species that die after this are considered extant</span></span>
<span id="cb10-19"><a href="#cb10-19"></a>tMax &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb10-20"><a href="#cb10-20"></a></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="co"># run the simulation</span></span>
<span id="cb10-22"><a href="#cb10-22"></a>sim &lt;-<span class="st"> </span><span class="kw">bd.sim</span>(n0, pp, qq, tMax)</span>
<span id="cb10-23"><a href="#cb10-23"></a></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co"># check the resulting clade out</span></span>
<span id="cb10-25"><a href="#cb10-25"></a>ape<span class="op">::</span><span class="kw">plot.phylo</span>(<span class="kw">make.phylo</span>(sim), <span class="dt">show.tip.label =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEmUlEQVR4nO3ai5LaOBQAUfP/P51KaoZgy1br5Qe63VW7MwtGkk/JhpBdXpZtuXsBT08gSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBoVqBlv4aBxq/tnA7OuKHKec85nfHlFzqKo3beB3W80LEg5fM+rAzQq+4CHDXvwwKg42fjAe2dcZ5v/crWeZ/c6ry2S4ZL7LV9unLqzqVf07LaQdsns2e9JHrVU39Bb6CjM4x+D/oP9Npfcs2npOqpvyAGqqh66i8IgQ5eFgrofXY1uyUQ0OaX+iEEOn51pB3UelFFAWp89aw7qPWkDoeZDij5pXfAUEBt96NIQGVjdF6n8wP9/afjLEMAffxX4Eus6JazVO+miYBojOg3aQT69y+BkqNWOycsUMGJz32J0e03/Wo+1gdFfHYp+bAj0O5R7qCf39Mz3/scFBgoPfr9vhV7B73POkMRG+jwyO0We8W8xDJAyb5ZZv2zWO7ZY6DVwV5iRQPGAvrYEYcfm3cauYabK1pc+RkItH68ccu0rOGu2oG8xOCg3z96CJT5KmT1MzBQ9pUdMt1ruKB+oPWDj9lBuVtkVaesoHKk5jVcMGjDOMPVJwJKTl+gnaPdQXuHwZkL9PsD9oxAB8e7g35+FFxkp63hnkF3xsnedgvu0NPvoL2h08cEaptOoPcj7qDVYwUIkwPVnl64HbSkD9UPFg8ou0/cQeXTCASjxALKnGrRNTU70P402b0RawftT7OUTxsKaLMrhr1z7a5hZBcBfRyYQIywKZr61kGLgTbHDdk6lVPfMmg9UEmNaxjZbUA9Xx3SGkZ2BVD99gi2g/CNbR9vWqDeW8lrzh30XyMZsmGOJthHA30MmAI1Vzv1CZ0E1G4SA+hEhezUJ3QSUOcY8++gjtf/g5kbqOuyWd3B6l86vPt30PEtaVKgpRYoef3k72JL37tYDKABKxAoWUH3R6RZgXpM1iN1vPa6QZtuPIOm/opBi/8X3/GMXwpUdLqBgJIRczfhiDvoGCj7IoGqh5kXqG8bfHwfPS1Q0wxb0Jl3UNMM6783mvoexEDZG/L8N+kCIFjI3EDZL3iOTzzO23zBkHhEeKCWt/8RE7cM2vWZpWDIESOWTnzhXF+ZQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBA0B9E+zhdPcJKtgAAAABJRU5ErkJggg==" /><!-- --></p>
<p>A lot of species! We can then create a fossil record from this group.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># again set a seed</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co"># set the sampling rate</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co"># using a simple case - there will be on average T occurrences per species,</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co"># where T is the species duration</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>rr &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb11-8"><a href="#cb11-8"></a></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co"># run the sampling simulation only for the first 15 species for brevity&#39;s sake</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>samp &lt;-<span class="st"> </span><span class="kw">suppressMessages</span>(<span class="kw">sample.clade</span>(<span class="dt">S =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, <span class="dt">sim =</span> sim, <span class="dt">rr =</span> rr, <span class="dt">tMax =</span> tMax))</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co"># suppressing messages - the message is to inform the user how many species</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co"># left no fossils. In this case, it was 0</span></span>
<span id="cb11-13"><a href="#cb11-13"></a></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co"># take a look at how the output is organized</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="kw">head</span>(samp)</span></code></pre></div>
<pre><code>##   Species Extant MinT MaxT
## 1   spp_1  FALSE 49.6 49.7
## 2   spp_1  FALSE 49.2 49.3
## 3   spp_1  FALSE 48.3 48.4
## 4   spp_1  FALSE 45.9 46.0
## 5   spp_1  FALSE 45.7 45.8
## 6   spp_1  FALSE 43.4 43.5</code></pre>
<p>The output of <code>sample.clade</code> is a data frame organized as follows</p>
<ul>
<li><code>Species</code> the species name, usually <code>spp_</code> followed by the number in the order it is organized on <code>sim</code>.</li>
<li><code>Extant</code> whether the species is extant or not.</li>
<li><code>minT</code> the lower bound of the geologic range the fossil is found. The range vectors is an input, <code>bins</code>, used to simulate the granularity of the fossil record. If not provided, <code>bins</code> will go from <code>tMax</code> to <code>0</code> by <code>-0.01</code>.</li>
<li><code>maxT</code> the upper bound of the geologic range the fossil is found.</li>
</ul>
<p>This data frame organization allows for easy evaluation of its components, and is close to ready for use in PyRate, one of the most widely used birth-death rates estimators in the field currently. To make it ready we must manipulate the <code>Extant</code> column, left like this for clarity. In PyRate, that column must be <code>status</code>, with extant species marked <code>extant</code> and extinct species marked <code>extinct</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># make a copy</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>pSamp &lt;-<span class="st"> </span>samp</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co"># change the extant column</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>pSamp[<span class="st">&quot;Extant&quot;</span>][pSamp[<span class="st">&quot;Extant&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>] =<span class="st"> &quot;extant&quot;</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>pSamp[<span class="st">&quot;Extant&quot;</span>][pSamp[<span class="st">&quot;Extant&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>] =<span class="st"> &quot;extinct&quot;</span></span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co"># change column names</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="kw">colnames</span>(pSamp) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Species&quot;</span>, <span class="st">&quot;Status&quot;</span>, <span class="st">&quot;min_age&quot;</span>, <span class="st">&quot;max_age&quot;</span>)</span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co"># check it out</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="kw">head</span>(pSamp)</span></code></pre></div>
<pre><code>##   Species Status min_age max_age
## 1   spp_1 extant    49.6    49.7
## 2   spp_1 extant    49.2    49.3
## 3   spp_1 extant    48.3    48.4
## 4   spp_1 extant    45.9    46.0
## 5   spp_1 extant    45.7    45.8
## 6   spp_1 extant    43.4    43.5</code></pre>
<p>This data frame could be directly dropped in PyRate for rate estimations.</p>
<p>We can also use <code>RMark</code> or other simpler methods to check estimations. Let us write a quick function applying Foote’s Per Capita method.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>per.capita &lt;-<span class="cf">function</span>(faBins, laBins, bins) {</span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="co"># create vectors to hold species that were born before and die in interval i,</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="co"># species who were born in i and die later,</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="co"># and species who were born before and die later</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  NbL &lt;-<span class="st"> </span>NFt &lt;-<span class="st"> </span>Nbt &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(bins))</span>
<span id="cb15-6"><a href="#cb15-6"></a>  </span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="co"># for each interval</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(bins)) {</span>
<span id="cb15-9"><a href="#cb15-9"></a>    <span class="co"># number of species that were already around before i and are not seen again</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>    NbL[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(faBins <span class="op">&gt;</span><span class="st"> </span>bins[i] <span class="op">&amp;</span><span class="st"> </span>laBins <span class="op">==</span><span class="st"> </span>bins[i])</span>
<span id="cb15-11"><a href="#cb15-11"></a>    </span>
<span id="cb15-12"><a href="#cb15-12"></a>    <span class="co"># number of species that were first seen in i and are seen later</span></span>
<span id="cb15-13"><a href="#cb15-13"></a>    NFt[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(faBins <span class="op">==</span><span class="st"> </span>bins[i] <span class="op">&amp;</span><span class="st"> </span>laBins <span class="op">&lt;</span><span class="st"> </span>bins[i])</span>
<span id="cb15-14"><a href="#cb15-14"></a>    </span>
<span id="cb15-15"><a href="#cb15-15"></a>    <span class="co"># number of species that were first seen before i and are seen after i</span></span>
<span id="cb15-16"><a href="#cb15-16"></a>    Nbt[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(faBins <span class="op">&gt;</span><span class="st"> </span>bins[i] <span class="op">&amp;</span><span class="st"> </span>laBins <span class="op">&lt;</span><span class="st"> </span>bins[i])</span>
<span id="cb15-17"><a href="#cb15-17"></a>  }</span>
<span id="cb15-18"><a href="#cb15-18"></a>  </span>
<span id="cb15-19"><a href="#cb15-19"></a>  <span class="co"># calculate the total rates</span></span>
<span id="cb15-20"><a href="#cb15-20"></a>  p &lt;-<span class="st"> </span><span class="kw">log</span>((NFt <span class="op">+</span><span class="st"> </span>Nbt) <span class="op">/</span><span class="st"> </span>Nbt)</span>
<span id="cb15-21"><a href="#cb15-21"></a>  q &lt;-<span class="st"> </span><span class="kw">log</span>((NbL <span class="op">+</span><span class="st"> </span>Nbt) <span class="op">/</span><span class="st"> </span>Nbt)</span>
<span id="cb15-22"><a href="#cb15-22"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">p =</span> p, <span class="dt">q =</span> q))</span>
<span id="cb15-23"><a href="#cb15-23"></a>}</span></code></pre></div>
<p>To apply this function, we need to manipulate <code>samp</code> a little bit</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># get the species names</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>ids &lt;-<span class="st"> </span><span class="kw">unique</span>(samp<span class="op">$</span>Species)</span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co"># get the first appearance bins - the first time in bins where the fossil was seen (lower bound)</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>faBins &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(ids, <span class="cf">function</span>(i) <span class="kw">max</span>(samp<span class="op">$</span>MaxT[samp<span class="op">$</span>Species <span class="op">==</span><span class="st"> </span>i])))</span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co"># get the last appearance bins - last time in bins where the fossil was seen (upper bound)</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>laBins &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(ids, <span class="cf">function</span>(i) <span class="kw">min</span>(samp<span class="op">$</span>MinT[samp<span class="op">$</span>Species <span class="op">==</span><span class="st"> </span>i])))</span>
<span id="cb16-9"><a href="#cb16-9"></a></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co"># create the bins vector we have been using</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>bins &lt;-<span class="st"> </span><span class="kw">seq</span>(tMax, <span class="dv">0</span>, <span class="fl">-0.1</span>)</span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co"># note this has a high resolution, the actual stratigraphic ranges are much coarser</span></span>
<span id="cb16-13"><a href="#cb16-13"></a></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co"># get the estimates</span></span>
<span id="cb16-15"><a href="#cb16-15"></a>pc &lt;-<span class="st"> </span><span class="kw">per.capita</span>(faBins, laBins, bins)</span></code></pre></div>
<p>This method assumes perfect sampling, so it will not be a good estimate, but it is nevertheless a good example of <code>sample.cade</code> use. One could then clean up <code>pc</code> and plot the rates, but for sampling as imperfect as we have here it will not be a good estimate.</p>
<p>Other examples of methods using only the fossil record are Capture-Mark-Recapture (Liow &amp; Nichols 2010) and the Alroy 3-timer (Alroy 2014). One could also use <code>paleobuddy</code> to test methods that integrate fossil records and phylogenies, such as the Fossilized birth-death model (Stadler et al 2010, Heath et al 2014). While a thorough test of these methods are not in the scope of this vignette, we believe to have shown the workflow required for such tests.</p>
</div>
<div id="paleobuddys-flexibility" class="section level2">
<h2>paleobuddy’s flexibility</h2>
<p>While showing use cases of the package is great, we should also spend some time detailing the possible customization options in <code>bd.sim</code> and <code>sample.clade</code>.</p>
<p>We have already shown speciation and extinction rates can be any function of time, or constant numbers. Let us check some other possibilities out.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># set a seed</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># parameters to set things up</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>n0 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>tMax &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb17-7"><a href="#cb17-7"></a></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co"># speciation can be dependent on an environmental variable as well as time</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>pp &lt;-<span class="st"> </span><span class="cf">function</span>(t, env) {</span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="fl">0.01</span> <span class="op">*</span><span class="st"> </span>t <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span><span class="op">*</span><span class="kw">exp</span>(<span class="fl">0.1</span><span class="op">*</span>env)</span>
<span id="cb17-11"><a href="#cb17-11"></a>}</span>
<span id="cb17-12"><a href="#cb17-12"></a></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co"># let us generate some fake environmental data - you can pretend this is </span></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="co"># percentage of max temperature or something</span></span>
<span id="cb17-15"><a href="#cb17-15"></a>Env &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="kw">runif</span>(<span class="dv">20</span>))</span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="co"># the package RPANDA supplies some useful environmental data frames - see ?bd.sim and ?bd.sim general for</span></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="co"># examples with real data</span></span>
<span id="cb17-18"><a href="#cb17-18"></a></span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="co"># we can make extinction be age-dependent by creating a shape parameter</span></span>
<span id="cb17-20"><a href="#cb17-20"></a>qq &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb17-21"><a href="#cb17-21"></a>qShape &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="co"># this will make it so species durations are distributed as a Weibull with scale 10 and shape 2</span></span>
<span id="cb17-23"><a href="#cb17-23"></a></span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="co"># run the simulation</span></span>
<span id="cb17-25"><a href="#cb17-25"></a><span class="co"># we pass the shape and environmental parameters</span></span>
<span id="cb17-26"><a href="#cb17-26"></a>sim &lt;-<span class="st"> </span><span class="kw">bd.sim</span>(n0, pp, qq, tMax, <span class="dt">qShape =</span> qShape, <span class="dt">envPP =</span> Env)</span>
<span id="cb17-27"><a href="#cb17-27"></a><span class="co"># note that pShape and envQQ also exist</span></span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="co"># the defaults for all of these customization options is NULL</span></span>
<span id="cb17-29"><a href="#cb17-29"></a></span>
<span id="cb17-30"><a href="#cb17-30"></a><span class="co"># check out the phylogeny</span></span>
<span id="cb17-31"><a href="#cb17-31"></a>ape<span class="op">::</span><span class="kw">plot.phylo</span>(<span class="kw">make.phylo</span>(sim), <span class="dt">show.tip.label =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADcklEQVR4nO3YS3LbMBQAQef+l84uqSSujEjhQ1I9a/EB7nIBlL5+6L997d7A1QMUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKHo20Nd3HRwxZ2cXacBfB2j+iAsHKPoooG8P3GrAsu+PWNSZnf7xzNNvsfeBli27J0DRKaD3D6RnAw0YAGj2sst6H8gt9qBlTwQoAhQBij4YaOoXzyf8ovjaHs4CnXts2PMjAhQBigBFc4Ec0lMeG/b8iMYATfpZ+kFA7ww/v+yKAEWAorlAbrFDUw53I6A5X2bHbG5uY/YAaMmUVWMPBSgaDDT2rHoi0JBxc6adC1A0CGjOfT8FKF9Zpr7B3AFo6x5ucEhfYQ+jAhQBigBFgKIPAnKLTVkG0JSnxg4dtYcpL+yPApqxDKD3hp7rokCPucWO/hgw6VeB7ze3Y+g/QGuWvc9QQAc/Dig+Dig+fhpoxlH+JKApAYouAbTifeZsVwAa/PjYbgZ0+iX71of0gcfX/3MBigBFgKJLAg07YQd0RaCY7BaLyWv/iwC9sOI9hv6aDOh/k5cf1DcDmj99yWrXAvqoW+zM9Pd2A2jq0yuH/p4+983w79UG7Xr+0NMBigBFH3eLrQ1QBCgCFD0N6NN/MFu/NKDVA+cNXfC94rtlRw/cPBTQ6qUfB/S4W+zFo2XC6fLi/nYPffmzgAYOHRigHcsCqqFHmjJ03GG//Yv39g1E2/e3fQPR9v1t30C0fX/bNxBt39+ks3Xc/jate5sARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFD0E5v5PvE1+7wAAAAAAElFTkSuQmCC" /><!-- --></p>
<p>So as to avoid repetition, we will not run simulations for the next possibilities, but we will list them</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># speciation may be a step function, presented as a rates vector and a shift times vector</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>pList &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a>pShifts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">15</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co"># pShifts could also be c(tMax, tMax - 10, tMax - 15) for identical results</span></span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co"># make.rate is the function bd.sim calls to create a rate, but we will use it here to see how it looks</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>pp &lt;-<span class="st"> </span><span class="kw">make.rate</span>(pList, <span class="dt">tMax =</span> <span class="dv">20</span>, <span class="dt">fShifts =</span> pShifts)</span>
<span id="cb18-8"><a href="#cb18-8"></a>t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="fl">0.1</span>)</span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="kw">plot</span>(t, <span class="kw">pp</span>(t), <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="st">&quot;Step function speciation rate&quot;</span>,</span>
<span id="cb18-10"><a href="#cb18-10"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Time (My)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Rate&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># it is not possible to combine the pp(t, env) and pList methods listed above</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co"># but we can create a step function dependent on environmental data with ifelse</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>q &lt;-<span class="st"> </span><span class="cf">function</span>(t, env) {</span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="kw">ifelse</span>(t <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>, env,</span>
<span id="cb19-5"><a href="#cb19-5"></a>         <span class="kw">ifelse</span>(t <span class="op">&lt;</span><span class="st"> </span><span class="dv">15</span>, env <span class="op">*</span><span class="st"> </span><span class="dv">2</span>, env <span class="op">/</span><span class="st"> </span><span class="dv">2</span>))</span>
<span id="cb19-6"><a href="#cb19-6"></a>}</span>
<span id="cb19-7"><a href="#cb19-7"></a></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co"># pass it to make.rate with environmental data</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>qq &lt;-<span class="st"> </span><span class="kw">make.rate</span>(q, <span class="dt">envF =</span> Env)</span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="kw">plot</span>(t, <span class="kw">qq</span>(t), <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="st">&quot;Environmental step function extinction rate&quot;</span>,</span>
<span id="cb19-11"><a href="#cb19-11"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Time (My)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Rate&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note all these customization options could serve for a weibull scale as well, if the user wishes to have age-dependent speciation and/or extinction. The possibility of age-dependency with time-varying rates is, to our knowledge, exclusive to <code>paleobuddy</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># set seed again</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co"># age-dependent speciation with a step function</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>pList &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">12</span>)</span>
<span id="cb20-6"><a href="#cb20-6"></a>pShifts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">15</span>)</span>
<span id="cb20-7"><a href="#cb20-7"></a>pShape &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb20-8"><a href="#cb20-8"></a></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co"># age-dependent extinction with a step function of an environmental variable</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>q &lt;-<span class="st"> </span><span class="cf">function</span>(t, env) {</span>
<span id="cb20-11"><a href="#cb20-11"></a>  <span class="kw">ifelse</span>(t <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>, <span class="dv">20</span><span class="op">*</span>env,</span>
<span id="cb20-12"><a href="#cb20-12"></a>         <span class="kw">ifelse</span>(t <span class="op">&lt;</span><span class="st"> </span><span class="dv">15</span>, <span class="dv">10</span><span class="op">*</span>env, <span class="dv">13</span><span class="op">*</span>env <span class="op">/</span><span class="st"> </span><span class="dv">2</span>))</span>
<span id="cb20-13"><a href="#cb20-13"></a>}</span>
<span id="cb20-14"><a href="#cb20-14"></a>qShape &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb20-15"><a href="#cb20-15"></a></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="co"># run the simulation</span></span>
<span id="cb20-17"><a href="#cb20-17"></a>sim &lt;-<span class="st"> </span><span class="kw">bd.sim</span>(n0, pList, q, tMax, <span class="dt">pShape =</span> <span class="fl">0.5</span>, <span class="dt">qShape =</span> <span class="dv">2</span>, <span class="dt">envQQ =</span> Env, <span class="dt">pShifts =</span> pShifts)</span></code></pre></div>
<p>We set this to not run because it takes a long time - both because of the high speciation and because the method of creating a step function rate with <code>shifts</code> and <code>lists</code> takes a long time to integrate. It is however a good illustration of the power of <code>paleobuddy</code>s flexibility.</p>
<p>Note shape may also be a time-varying function, but that was not thoroughly tested and therefore not a recommended feature at the moment.</p>
<p>None of the scenarios we have listed here are specific to speciation or extinction - one can mix and match any combination listed here for either rate.</p>
<p>In the case of sampling rates, it is almost the case that any scenario available to speciation/extinction is available to sampling. We do not allow for a <code>shape</code> parameter since the Weibull distribution is not frequently used in the literature for age-dependent sampling. Instead, we allow for the user to supply a probability distribution signifying how occurrences are distributed along a species age, as follows</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># as an example, we will use a PERT distribution, a hat-shaped distribution used in PyRate</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co"># preservation function</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>dPERT &lt;-<span class="st"> </span><span class="cf">function</span>(t, s, e, sp, <span class="dt">a =</span> <span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">3</span>, <span class="dt">log =</span> <span class="ot">FALSE</span>) {</span>
<span id="cb21-4"><a href="#cb21-4"></a></span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="co"># check if it is a valid PERT</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="cf">if</span> (e <span class="op">&gt;=</span><span class="st"> </span>s) {</span>
<span id="cb21-7"><a href="#cb21-7"></a>    <span class="kw">message</span>(<span class="st">&quot;There is no PERT with e &gt;= s&quot;</span>)</span>
<span id="cb21-8"><a href="#cb21-8"></a>    <span class="kw">return</span>(<span class="kw">rep</span>(<span class="ot">NaN</span>, <span class="dt">times =</span> <span class="kw">length</span>(t)))</span>
<span id="cb21-9"><a href="#cb21-9"></a>  }</span>
<span id="cb21-10"><a href="#cb21-10"></a></span>
<span id="cb21-11"><a href="#cb21-11"></a>  <span class="co"># find the valid and invalid times</span></span>
<span id="cb21-12"><a href="#cb21-12"></a>  id1 &lt;-<span class="st"> </span><span class="kw">which</span>(t <span class="op">&lt;=</span><span class="st"> </span>e <span class="op">|</span><span class="st"> </span>t <span class="op">&gt;=</span><span class="st"> </span>s)</span>
<span id="cb21-13"><a href="#cb21-13"></a>  id2 &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span>(t <span class="op">&lt;=</span><span class="st"> </span>e <span class="op">|</span><span class="st"> </span>t <span class="op">&gt;=</span><span class="st"> </span>s))</span>
<span id="cb21-14"><a href="#cb21-14"></a>  t &lt;-<span class="st"> </span>t[id2]</span>
<span id="cb21-15"><a href="#cb21-15"></a></span>
<span id="cb21-16"><a href="#cb21-16"></a>  <span class="co"># initialize result vector</span></span>
<span id="cb21-17"><a href="#cb21-17"></a>  res &lt;-<span class="st"> </span><span class="kw">vector</span>()</span>
<span id="cb21-18"><a href="#cb21-18"></a></span>
<span id="cb21-19"><a href="#cb21-19"></a>  <span class="co"># if user wants a log function</span></span>
<span id="cb21-20"><a href="#cb21-20"></a>  <span class="cf">if</span> (log) {</span>
<span id="cb21-21"><a href="#cb21-21"></a>    <span class="co"># invalid times get -Inf</span></span>
<span id="cb21-22"><a href="#cb21-22"></a>    res[id1] &lt;-<span class="st"> </span><span class="op">-</span><span class="ot">Inf</span></span>
<span id="cb21-23"><a href="#cb21-23"></a></span>
<span id="cb21-24"><a href="#cb21-24"></a>    <span class="co"># valid times calculated with log</span></span>
<span id="cb21-25"><a href="#cb21-25"></a>    res[id2] &lt;-<span class="st"> </span><span class="kw">log</span>(((s <span class="op">-</span><span class="st"> </span>t) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)<span class="op">*</span>((<span class="op">-</span>e <span class="op">+</span><span class="st"> </span>t) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)<span class="op">/</span>((s <span class="op">-</span><span class="st"> </span>e) <span class="op">^</span><span class="st"> </span><span class="dv">5</span><span class="op">*</span><span class="kw">beta</span>(a,b)))</span>
<span id="cb21-26"><a href="#cb21-26"></a>  }</span>
<span id="cb21-27"><a href="#cb21-27"></a>  <span class="co"># otherwise</span></span>
<span id="cb21-28"><a href="#cb21-28"></a>  <span class="cf">else</span>{</span>
<span id="cb21-29"><a href="#cb21-29"></a>    res[id1] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb21-30"><a href="#cb21-30"></a></span>
<span id="cb21-31"><a href="#cb21-31"></a>    res[id2] &lt;-<span class="st"> </span>((s <span class="op">-</span><span class="st"> </span>t) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)<span class="op">*</span>((<span class="op">-</span>e <span class="op">+</span><span class="st"> </span>t) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)<span class="op">/</span>((s <span class="op">-</span><span class="st"> </span>e) <span class="op">^</span><span class="st"> </span><span class="dv">5</span><span class="op">*</span><span class="kw">beta</span>(a,b))</span>
<span id="cb21-32"><a href="#cb21-32"></a>  }</span>
<span id="cb21-33"><a href="#cb21-33"></a></span>
<span id="cb21-34"><a href="#cb21-34"></a>  <span class="kw">return</span>(res)</span>
<span id="cb21-35"><a href="#cb21-35"></a>}</span>
<span id="cb21-36"><a href="#cb21-36"></a></span>
<span id="cb21-37"><a href="#cb21-37"></a><span class="co"># function to calculate max of the PERT - makes the sampling faster</span></span>
<span id="cb21-38"><a href="#cb21-38"></a>dPERTmax &lt;-<span class="st"> </span><span class="cf">function</span>(s, e, sp) {</span>
<span id="cb21-39"><a href="#cb21-39"></a>  <span class="kw">return</span>(((s <span class="op">-</span><span class="st"> </span>e) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>e)</span>
<span id="cb21-40"><a href="#cb21-40"></a>}</span>
<span id="cb21-41"><a href="#cb21-41"></a></span>
<span id="cb21-42"><a href="#cb21-42"></a><span class="co"># set seed</span></span>
<span id="cb21-43"><a href="#cb21-43"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb21-44"><a href="#cb21-44"></a></span>
<span id="cb21-45"><a href="#cb21-45"></a><span class="co"># generate a quick simulation</span></span>
<span id="cb21-46"><a href="#cb21-46"></a>sim &lt;-<span class="st"> </span><span class="kw">bd.sim</span>(n0, <span class="dt">pp =</span> <span class="fl">0.1</span>, <span class="dt">qq =</span> <span class="fl">0.05</span>, <span class="dt">tMax =</span> <span class="dv">20</span>)</span>
<span id="cb21-47"><a href="#cb21-47"></a></span>
<span id="cb21-48"><a href="#cb21-48"></a><span class="co"># another seed</span></span>
<span id="cb21-49"><a href="#cb21-49"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb21-50"><a href="#cb21-50"></a></span>
<span id="cb21-51"><a href="#cb21-51"></a><span class="co"># sample - high sampling rate so we can visualize the age-dependency</span></span>
<span id="cb21-52"><a href="#cb21-52"></a>samp &lt;-<span class="st"> </span><span class="kw">sample.clade</span>(<span class="dt">sim =</span> sim, <span class="dt">rr =</span> <span class="dv">30</span>, <span class="dt">tMax =</span> <span class="dv">20</span>, <span class="dt">bins =</span> bins,</span>
<span id="cb21-53"><a href="#cb21-53"></a>                  <span class="dt">dFun =</span> dPERT, <span class="dt">dFunMax =</span> dPERTmax)</span></code></pre></div>
<pre><code>## 0 species left no fossil</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># extract species identity</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>ids &lt;-<span class="st"> </span><span class="kw">unique</span>(samp<span class="op">$</span>Species)</span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co"># approximate sampling time (since it is a range)</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>mids &lt;-<span class="st"> </span>(samp<span class="op">$</span>MaxT <span class="op">-</span><span class="st"> </span>samp<span class="op">$</span>MinT) <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>samp<span class="op">$</span>MinT</span>
<span id="cb23-6"><a href="#cb23-6"></a></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co"># for each species</span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(ids)) {</span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="co"># get the species number</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>  sp &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">as.numeric</span>(<span class="kw">gsub</span>(<span class="st">&quot;spp_&quot;</span>, <span class="st">&quot;&quot;</span>, ids[i])))</span>
<span id="cb23-11"><a href="#cb23-11"></a></span>
<span id="cb23-12"><a href="#cb23-12"></a>  <span class="co"># check the histogram</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>  <span class="kw">hist</span>(mids[samp<span class="op">$</span>Species <span class="op">==</span><span class="st"> </span>ids[[i]]],</span>
<span id="cb23-14"><a href="#cb23-14"></a>       <span class="dt">main =</span> <span class="kw">paste0</span>(<span class="st">&quot;spp = &quot;</span>, sp, <span class="st">&quot;; duration ~ &quot;</span>,</span>
<span id="cb23-15"><a href="#cb23-15"></a>                     <span class="kw">round</span>(sim<span class="op">$</span>TS[sp] <span class="op">-</span><span class="st"> </span>sim<span class="op">$</span>TE[sp], <span class="dt">digits =</span> <span class="dv">2</span>), <span class="st">&quot;my&quot;</span>),</span>
<span id="cb23-16"><a href="#cb23-16"></a>       <span class="dt">xlab =</span> <span class="st">&quot;Time (My)&quot;</span>, <span class="dt">probability =</span> <span class="ot">TRUE</span>)</span>
<span id="cb23-17"><a href="#cb23-17"></a></span>
<span id="cb23-18"><a href="#cb23-18"></a>  <span class="co"># expected curve</span></span>
<span id="cb23-19"><a href="#cb23-19"></a>  <span class="kw">curve</span>(<span class="kw">dPERT</span>(x, <span class="dt">s =</span> sim<span class="op">$</span>TS[sp], <span class="dt">e =</span> sim<span class="op">$</span>TE[sp], <span class="dt">sp =</span> sp), <span class="dt">from =</span> sim<span class="op">$</span>TE[sp],</span>
<span id="cb23-20"><a href="#cb23-20"></a>        <span class="dt">to =</span> sim<span class="op">$</span>TS[sp], <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">n =</span> <span class="dv">100</span>)</span>
<span id="cb23-21"><a href="#cb23-21"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>For more details and examples of age-dependent models, check out <code>?sample.adpp</code> and <code>?sample.clade</code>. When a <code>dFun</code> argument is supplied for age dependency, the average sampling rate <code>rr</code> must be a constant. We omit examples of non-age-dependent sampling rate options since they are just the same options as birth-death rates, excluding shape parameters.</p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>For completion, we present a final list of the functions of the package</p>
<ul>
<li><code>bd.sim</code> birth-death simulator. Rates can be constant, time dependent, time and enviromentally dependent, or a list of numbers. User can supply a shape parameter to make rate a Weibull scale.</li>
<li><code>bd.sim.constant</code> function called by <code>bd.sim</code> when rates are constant.</li>
<li><code>bd.sim.general</code> function called by <code>bd.sim</code> when they are not.</li>
<li><code>make.phylo</code> creates a <code>phylo</code> object from the <code>ape</code> package.</li>
<li><code>sample.clade</code> samples a whole group, usually outputted from <code>bd.sim</code>. Sampling rate can be anything a speciation or extinction rate can be, without the option of a shape parameter. If sampling is constant, the user may also supply a distribution of age-dependent occurrences.</li>
<li><code>sample.species</code> function called by <code>sample.clade</code> when sampling is not age-dependent</li>
<li><code>sample.adpp</code> function called by <code>sample.clade</code> when sampling is age-dependent (i.e. Age Dependent Poisson Process)</li>
<li><code>rexp.var</code> exponential and weibull waiting time drawing with variable rates. Used by <code>bd.sim</code> and <code>sample.clade</code>.</li>
<li><code>find.lineages</code> separates a group returned by the <code>bd.sim</code> function, or similar, by the species that started the simulation as mothers of each group. Allows for an optional argument, a list of numbers, and if supplied returns the groups generated by those species instead. A quick example:</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># simple simulation, starting with more than one species</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>sim &lt;-<span class="st"> </span><span class="kw">bd.sim</span>(<span class="dt">n0 =</span> <span class="dv">2</span>, <span class="dt">pp =</span> <span class="fl">0.1</span>, <span class="dt">qq =</span> <span class="dv">0</span>, <span class="dt">tMax =</span> <span class="dv">20</span>, <span class="dt">nFinal =</span> <span class="kw">c</span>(<span class="dv">20</span>, <span class="ot">Inf</span>))</span>
<span id="cb24-3"><a href="#cb24-3"></a></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co"># separate the lineages</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>clades &lt;-<span class="st"> </span><span class="kw">find.lineages</span>(sim)</span>
<span id="cb24-6"><a href="#cb24-6"></a></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co"># plot each phylogeny</span></span>
<span id="cb24-8"><a href="#cb24-8"></a></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="co"># clade 1</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>ape<span class="op">::</span><span class="kw">plot.phylo</span>(<span class="kw">make.phylo</span>(clades<span class="op">$</span>clade_<span class="dv">1</span>), <span class="dt">show.tip.label =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACd0lEQVR4nO3ZMW7DQBAEQfr/n3bk1A0BOg1FVD9gllcprx/927X+gLsHKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFD0CKDrpV7cPvPJn+3kIwANtz8WoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEVfB/Tan843dOIRf2/5mtHRPUCLbUCL0dE9QIttQIvR0T1Ai21Ai9HRPUCLbUCL0dE9QIttQIvR0T1Ai21Ai9HRPUCLbUCL0dE9QIttQIvR0b1nAB38DfsIoJMBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBis4A3bobAD0pQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIU/QIaI0In8hYqqwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># clade 2</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>ape<span class="op">::</span><span class="kw">plot.phylo</span>(<span class="kw">make.phylo</span>(clades<span class="op">$</span>clade_<span class="dv">2</span>), <span class="dt">show.tip.label =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADaklEQVR4nO3ZS3IaQRBAQXz/S3vhlUPAg5n+DCLfzmFT1cqQphG+/dHTbrsPcPUARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYqmAN0u3RWAZgzdFKAIUAQoAhQBij4SyDW/ef70XYB2DF04f/ouQDuGLpw/fddmILdYAS3cdaGhr88H9EuBzr3/feMx8rFAs+cffAwf2TVl6HSg8YtGD3s+dCfQR1zzW4EG7zoZoEND1wGdfvucu062GWjobkCHdp3sgkBfdosdeX99dNe6oZ/5KRGgHVMBHRoKKIYCiqHXAPqKa/6drWdPAWjwvz8xdDrQiI9rf06dctR1q94OUAQo+uJbbE6AIkARoAhQ9E1A3/OR68EOHQDQjBcdGwoohq4BGvh76r95ow/4eOgioEN/NfhFx4YCiqH7gVzzE7ZcHOjFTwkn/gf01YEWvGLtvCdDAcVQQDF0EdDgh9QOoI2P3PfbAnR20soA7TgBoHeG/nyeALrd/QOg+0PvXF5vTJrQia9lVOO+g/YHKAIUAYoARVuA9nbiaxlVAH1UgCJAEaAIUAQo+rVArvl3znCBOY+HAoqh54FWvGF+vHzQnP+H3j3pcaBlL5o454UNgGLDYqAr32L3N6wFGtVKoMNNP+Mrx7/wBkDTJ1x6OaDpGwDVhLGtPv7+DVMDFAGKAEWAoosDDb7Aft8ttv/bD9D2E6z8eZhx/N0HeN7+4+0/wdP2H2//CZ425t4681N7caD9AYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGg6C+n6D3CmQgE6QAAAABJRU5ErkJggg==" /><!-- --></p>
<ul>
<li><code>make.rate</code> creates a function of time from the customization options presented above - vector of numbers and vector of shif times, function of time and environment and an environment matrix, etc. Used by <code>bd.sim</code> and <code>sample.clade</code> to detect when the given rates are constant, and create the rates to pass to the helper functions.</li>
<li><code>var.rate.div</code> calculates the expected diversity from a variable rate birth-death process and a time period.</li>
<li><code>binner</code> given occurrence times and time bins, returns the number of occurrences in each bin.</li>
</ul>
<p>While the package is robust and flexible, it is useful to spend a little time discussing the shortcomings and planned features.</p>
<ul>
<li>Currently, time-varying shape is an untested feature of the package. This is a glaring omission given that time-varying scale is well tested, and we plan on devising better testing methods so we can effectively present this as a feature.</li>
<li>The method of generating step functions from rate and shift times vectors is currently very slow (see <code>?make.rate</code>), and we plan on looking for more efficient alternatives. Meanwhile, the user might prefer the creation of step functions using <code>ifelse</code> when prioritizing efficiency.</li>
<li>A couple of diversification scenarios are very well established in the literature and therefore are planned for future versions of the package: trait-dependent diversification, diversity-dependent rates, anagenesis/bifurcating speciation, etc.</li>
</ul>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
